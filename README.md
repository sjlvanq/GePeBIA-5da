# GePeBIA: Collaborative Multi-Agent System for Small Community Libraries (Capstone Project)

-----

## üåü Design Overview

This project implements the design principles of a **Level 3: Collaborative Multi-Agent System** [4, p. 17] which moves beyond a monolithic design toward a **"team of specialists"** working in concert. The system's robustness and scalability are achieved through a clear **division of labor**.

The architecture follows the **Core Agent Anatomy**: the reasoning Model (Brain) [4, p. 19-20], external Tools (Hands) [4, p. 20-22], and the Orchestration Layer [4, p. 22]:

| Agent | Role in the System | Core Architectural Concept | Function & Capability |
| :--- | :--- | :--- | :--- |
| **Iris** | **Orchestrator / User Experience (UX)** | **Orchestration Layer** | Manages the primary conversational flow and maintains the immediate **Session** history. |
| **Alec** | **Logistics and Inventory Specialist** | **Tools** (Function Calling) | Executes deterministic business logic, such as checking material availability and calculating loan terms. |
| **Gina** | **User Profile Manager** | **Memory** (Long-Term Persistence) | Handles multi-step user registration and manages persistent user profiles and preferences. |

## ü§ù Interoperability and Protocols

The system's collaboration relies on standardized mechanisms for communication and tool integration, adhering to AgentOps discipline [4, p. 27]:

### 1. Agent2Agent (A2A) Communication

The integration of `Alec` and `Gina` as specialized services consumed by `Iris` is achieved using the **Agent2Agent (A2A) Protocol** [5, p. 27].

*   **Decoupling:** A2A allows these specialized agents to run as independent services (simulating cross-team or cross-organization integration).
*   **Agent-as-a-Tool:** `Iris` integrates the remote agents by treating them as callable tools via the `RemoteA2aAgent` class [2, p. 13].

### 2. Structured Tool Design

The reliability of the system is improved by rigorous constraints on tool output and messaging:

*   **Design for Concise Output:** Tools must return small, structured JSON objects rather than large text blocks. This best practice prevents **Context Window Bloat**, which degrades the model's reasoning quality, increases latency, and raises token costs [2, p. 19].
*   **Describe Actions, Not Implementations:** The orchestrator's instructions must prompt the model on *what* needs to be accomplished (e.g., "Check availability") instead of specifying *how* to call the underlying tool implementation [2, p. 17-18].

## üõ°Ô∏è Quality, Observability, and Safety

The system is engineered for trustworthiness, operating under the principle that **Agent quality is an architectural pillar, not a final testing phase** [1, p. 46].

### 1. The Trajectory is the Truth

The specialist agents (`Alec`, `Gina`) are fundamentally constrained to enforce predictable behavior: they **MUST ALWAYS** call one tool and **MUST ONLY** return the exact, unmodified JSON output generated by that tool.

*   This rule implements the concept that **The Trajectory is the Truth** [1, p. 47]. Since the LLM's logic is non-deterministic [1, p. 11], the evaluation must assess the agent's entire decision-making process [1, p. 16-17].
*   This design makes the system **evaluatable-by-design** [1, p. 46], facilitating **Trajectory Evaluation** (the "Glass Box" approach) to audit reasoning, tool use, and robustness [1, p. 19-21].

### 2. Observability Foundation

Observability provides the essential technical foundation for judging the agent's complex process.

*   **Pillars of Observability:** The practice is built on **Logs** (atomic event records or the agent's diary) [1, p. 33-34], **Traces** (the narrative thread linking events to show cause and effect) [1, p. 36-37], and **Metrics** (the aggregated health report) [1, p. 38-40].

### 3. Context, Memory, and HITL Safety

*   **Memory Isolation:** The system utilizes **Memory** for long-term knowledge (user profiles), which is defined as being **highly isolated per-user** [3, p. 31, 38] to prevent data leakage and ensure privacy [3, p. 69].
*   **Human-in-the-Loop (HITL):** The **Golden Rule of Registration** in `Iris` enforces a mandatory confirmation step (`wait_for_user_confirmation`) before initiating a sensitive action like profile creation. This process integrates **Human-in-the-Loop (HITL) judgment** [1, p. 26] to anchor the system's safety and alignment with governance policies.

***

## üìù Bibliography

1. Meltem Subasioglu, Turan Bulmus, and Wafae Bakkali, *Agent Quality* (Google, November 2025).
2. Mike Styer, Kanchana Patlolla, Madhuranjan Mohan, and Sal Diaz, *Agent Tools & Interoperability with Model Context Protocol (MCP)* (Google, November 2025).
3. Kimberly Milam and Antonio Gulli, *Context Engineering: Sessions, Memory* (Google, November 2025).
4. Alan Blount, Antonio Gulli, Shubham Saboo, Michael Zimmermann, and Vladimir Vuskovic, *Introduction to Agents* (Google, November 2025).
5. Sokratis Kartakis, Gabriela Hernandez Larios, Ran Li, Elia Secchi, and Huang Xia, *Prototype to Production* (Google, November 2025).


-----


## üöÄ Installation and Setup

### Prerequisites

* **API Key:** A Google AI Studio API key is required. Get one at [https://aistudio.google.com](https://aistudio.google.com).
* **Install Dependencies:** Install all necessary Python libraries using `pip`:
    ```bash
    pip install -r requirements.txt
    ```

### Configuration

1.  **Configure API Key:** Open the `.env` file and replace the placeholder `YOUR-API-KEY` with your generated key from Google AI Studio.
2.  **Language Settings:** To change the default language, modify the relevant setting within the `config.json` file.

### Default Ports

The following default ports are used for each service:

* **Alec:** `8001` (Service: `alec_a2a:a2a_app`)
* **Gina:** `8003` (Service: `gina_a2a:a2a_app`)

## Running the Agents

### Gina Agent (Port 8003)

| Step | Command | Notes |
| :--- | :--- | :--- |
| **1. Change Directory** | `cd ./gina` | Navigate from the project root. |
| **2. Run (Windows)** | `uvicorn.exe --port 8003 --env-file ../.env --log-level=debug gina_a2a:a2a_app` | Uses `uvicorn.exe` wrapper. |
| **2. Run (Cross-platform)** | `python -m uvicorn gina_a2a:a2a_app --port 8003 --env-file ../.env --log-level debug` | Linux/macOS. |

### Alec Agent (Port 8001)

| Step | Command | Notes |
| :--- | :--- | :--- |
| **1. Change Directory** | `cd ./alec` | Navigate from the project root. |
| **2. Run (Windows)** | `uvicorn.exe --port 8001 --env-file ../.env --log-level=debug alec_a2a:a2a_app` | Uses `uvicorn.exe` wrapper. |
| **2. Run (Cross-platform)** | `python -m uvicorn alec_a2a:a2a_app --port 8001 --env-file ../.env --log-level debug` | Linux/macOS. |

### Iris

Once the Alec and Gina agents are running in their respective terminals, you can launch the Iris orchestrator:

* **To run in web mode:**
    ```bash
    adk web --log_level=debug .
    ```

* **To run the 'iris' target directly:**
    ```bash
    adk run --log_level=debug iris
    ```

